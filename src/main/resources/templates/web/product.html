<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{web/layout-default.html}">

<body>
	<div layout:fragment="content" class="product">
		<div class="site-section mt-5">
			<div class="container">
				<input type="hidden" id="currentPage" th:value="${currentPage}" />
				<div class="row">
					<!-- sidebar -->
					<div class="col-lg-3">
						<select onchange="location = this.value;">
							<option value="/web/product">Select Category</option>
							<th:block th:each="t : ${listAllCategory}">
								<option th:value="@{/web/product/(cateID=${t.cateId})}"
									th:class="${t.cateId == targetactive ? 'selected' : '' }">[[${t.name}]]</option>
							</th:block>
						</select>
						<!-- Toggle button -->
						<button class="btn btn-outline-secondary mb-3 w-100 d-lg-none" type="button"
							data-mdb-toggle="collapse" data-mdb-target="#navbarSupportedContent"
							aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
							<span>Show filter</span>
						</button>
						<!-- Collapsible wrapper -->
						<div class="collapse card d-lg-block mb-5" id="navbarSupportedContent">
							<div class="accordion" id="accordionPanelsStayOpenExample">
								<div class="accordion-item">
									<h2 class="accordion-header" id="headingThree">
										<button class="accordion-button text-dark bg-light" type="button"
											data-mdb-toggle="collapse" data-mdb-target="#panelsStayOpen-collapseThree"
											aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
											Price
										</button>
									</h2>
									<div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse show"
										aria-labelledby="headingThree">
										<div class="accordion-body">
											<div class="range">
												<input type="range" class="form-range" id="customRange1" />
											</div>
											<div class="row mb-3">
												<div class="col-6">
													<p class="mb-0">
														Min
													</p>
													<div class="form-outline">
														<input type="number" id="typeNumber" class="form-control" />
														<label class="form-label" for="typeNumber">$0</label>
													</div>
												</div>
												<div class="col-6">
													<p class="mb-0">
														Max
													</p>
													<div class="form-outline">
														<input type="number" id="typeNumber" class="form-control" />
														<label class="form-label" for="typeNumber">$1,0000</label>
													</div>
												</div>
											</div>
											<button type="button"
												class="btn btn-white w-100 border border-secondary">apply</button>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- sidebar -->
					<!-- content -->
					<div class="col-lg-9">
						<header class="d-sm-flex align-items-center border-bottom mb-4 pb-3">
							<strong class="d-block py-2">32 Items found </strong>
							<div class="ms-auto">
								<select class="form-select d-inline-block w-auto border pt-1">
									<option value="0">Best match</option>
									<option value="1">Recommended</option>
									<option value="2">High rated</option>
									<option value="3">Randomly</option>
								</select>
								<div class="btn-group shadow-0 border">
									<a href="#" class="btn btn-light" title="List view">
										<i class="fa fa-bars fa-lg"></i>
									</a>
									<a href="#" class="btn btn-light active" title="Grid view">
										<i class="fa fa-th fa-lg"></i>
									</a>
								</div>
							</div>
						</header>

						<div class="row">
							
							<th:block th:each="p : ${listAllProduct}">
								<div class="product col-lg-4 col-md-6 col-sm-6 d-flex">
									<div class="card w-100 my-2 shadow-2-strong">
										<img th:src="${p.image_link}" class="card-img-top"
											style="aspect-ratio: 1 / 1" />
										<div class="card-body d-flex flex-column justify-content-between">										
											<a th:href="'/web/product/detail/' + ${p.proId}" class="card-text text-center fw-normal">[[${p.name}]]</a>
											<h5 class="card-title text-center mt-1">
												<span class="text-body-tertiary text-decoration-line-through" th:text="${#numbers.formatDecimal(p.price, 0, 0)} + '.000 đ'"></span>
												<span class="fw-bold" th:text="${#numbers.formatDecimal(p.price * (100 - p.sale) / 100, 0, 0) } + '.000 đ'"></span>
											</h5>
										</div>
									</div>
								</div>
							</th:block>
						</div>
						
						<hr />

						<!-- Pagination -->
						<nav aria-label="Page navigation example" class="d-flex justify-content-center mt-3">
							<ul class="pagination">
								<li class="page-item disabled">
									<a class="page-link" href="#" aria-label="Previous">
										<span aria-hidden="true">&laquo;</span>
									</a>
								</li>
								<li class="page-item active"><a class="page-link" href="#">1</a></li>
								<li class="page-item"><a class="page-link" href="#">2</a></li>
								<li class="page-item"><a class="page-link" href="#">3</a></li>
								<li class="page-item"><a class="page-link" href="#">4</a></li>
								<li class="page-item"><a class="page-link" href="#">5</a></li>
								<li class="page-item">
									<a class="page-link" href="#" aria-label="Next">
										<span aria-hidden="true">&raquo;</span>
									</a>
								</li>
							</ul>
						</nav>
						<!-- Pagination -->
					</div>
				</div>
			</div>
			
		</div>
		<a onclick="loadMore()" class="btn btn-default">Load More</a>
	</div>
	<script>
		function loadMore(){
			loadAjax();
		}
		function loadAjax() {
			var amount = document.getElementsByClassName("product").length;
			var curPage = amount / 9; // Tính trang tiếp theo dựa trên số sản phẩm đã có

			$.ajax({
				url: "/web/product/loadAjax",
				type: "get",
				data: {
					exist: amount,
					page: curPage
				},
				success: function (data) {
					$("#content").append(data); // Thêm sản phẩm mới vào #content
				},
				error: function (xhr) {
					console.log("Error:", xhr);
				}
			});
		}
	</script>
</body>
</html>