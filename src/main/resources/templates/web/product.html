<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{web/layout-default.html}">

<body>
	<div layout:fragment="content" class="page-product">
		<div class="site-section mt-5">
			<div class="container">
				<div class="row">
					<!-- sidebar -->
					<div class="col-lg-3">
						<select id="mySelect" onchange="location=this.value;">	
							<option th:value="@{/web/product/0/page/1}">Select Category</option>
							<option th:each="t : ${listAllCategory}"
								th:value="@{'/web/product/' + ${t.cateId} + '/page/' + '1'}" th:text="${t.name}"
								th:class="${t.cateId == targetactive ? 'selected' : ''}" th:selected="${t.cateId == selectedCategoryId}"></option>
						</select>
						<select id="mySelectBrand" onchange="location=this.value;">	
							<option th:value="@{'/web/product/0/page/1?brandID=0'}">Select Brand</option>
							<option th:each="t : ${listAllBrand}"
								th:value="@{'/web/product/' + ${cateID} + '/page/' + '1?brandID=' + ${t.brandId}}" th:text="${t.name}"
								th:class="${t.brandId == targetactive ? 'selected' : ''}" th:selected="${t.brandId == brandID}"></option>
						</select>

						<!-- Toggle button -->
						<button class="btn btn-outline-secondary mb-3 w-100 d-lg-none" type="button"
							data-mdb-toggle="collapse" data-mdb-target="#navbarSupportedContent"
							aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
							<span>Show filter</span>
						</button>
						<!-- Collapsible wrapper -->
						<div class="collapse card d-lg-block mb-5" id="navbarSupportedContent">
							<div class="accordion" id="accordionPanelsStayOpenExample">
								<div class="accordion-item">
									<h2 class="accordion-header" id="headingThree">
										<button class="accordion-button text-dark bg-light" type="button"
											data-mdb-toggle="collapse" data-mdb-target="#panelsStayOpen-collapseThree"
											aria-expanded="false" aria-controls="panelsStayOpen-collapseThree">
											Price
										</button>
									</h2>
									<div id="panelsStayOpen-collapseThree" class="accordion-collapse collapse show"
										aria-labelledby="headingThree">
										<div class="accordion-body">
											<form action="" method="get">
												<div>
													<input type="hidden" id="range-price-min" th:value="${min_price}" name="min_price" />
													<input type="hidden" id="range-price-max" th:value="${max_price}" name ="max_price"/>
													<input type="hidden" th:value="${brandID}" name ="brandID"/>
												</div>
												<div>
													<input type="text" class="js-range-slider" value="" 
														data-type="double"
														th:attr="data-type='double', data-min=${min_price}, data-max=${max_price}, data-from=${min_form}, data-to=${max_form}, data-skin='round'" />
												</div>
												<div class="mb-3 mt-3 d-flex justify-content-between align-items-center">
													<span>Giá:</span> 
													<div>
														<span id="ui-price-min">[[${min_form}]].000đ</span> - <span id="ui-price-max">[[${max_form}]].000đ</span>
													</div>
												</div>
												
												<button type="submit"
													class="btn btn-white w-100 border border-secondary">Apply</button>
											</form>
										</div>
										
									</div>
								</div>
							</div>
						</div>
					</div>
					<!-- sidebar -->
					<!-- content -->
					<div class="col-lg-9">
						<header class="d-sm-flex align-items-center border-bottom mb-4 pb-3">
							<strong class="d-block py-2">[[${countPro}]] Items found </strong>
							<div class="ms-auto">
								<select class="form-select d-inline-block w-auto border pt-1" onchange="location=this.value;">
									<option th:value="@{'/web/product/' + ${cateID} + '/page/' + '1?orderby=menu_order'}" th:selected="${orderby == 'menu_order'}">Thứ tự mặc định</option>
									<option th:value="@{'/web/product/' + ${cateID} + '/page/' + '1?orderby=selling'}" th:selected="${orderby == 'selling'}">Thứ tự theo mực độ bán chạy</option>
									<option th:value="@{'/web/product/' + ${cateID} + '/page/' + '1?orderby=date'}" th:selected="${orderby == 'date'}">Mới nhất</option>
									<option th:value="@{'/web/product/' + ${cateID} + '/page/' + '1?orderby=price'}" th:selected="${orderby == 'price'}">Theo thứ tự giá: thấp đến cao</option>
									<option th:value="@{'/web/product/' + ${cateID} + '/page/' + '1?orderby=price-desc'}" th:selected="${orderby == 'price-desc'}">Theo thứ tự giá: cao đến thấp</option>
								</select>								
							</div>
						</header>

						<div class="row">

							<th:block th:each="p : ${listAllProduct}">
								<div class="product col-lg-4 col-md-6 col-sm-6 d-flex">
									<div class="card w-100 my-2 shadow-2-strong">
										<a style="display: inline-block; text-decoration: none;" th:href="'/web/product/detail/' + ${p.proId}">
											<img th:src="${p.image_link}" class="card-img-top"
											style="aspect-ratio: 1 / 1" />
										</a>
										<div class="card-body d-flex flex-column justify-content-between">										
											<a th:href="'/web/product/detail/' + ${p.proId}" class="card-text text-center fw-normal">[[${p.name}]]</a>
											<h5 class="card-title text-center mt-1">
												<span th:if="${p.sale > 0}" class="text-body-tertiary text-decoration-line-through"
													th:text="${#numbers.formatDecimal(p.price, 0, 0)} + '.000 đ'"></span>
												<span class="fw-bold"
													th:text="${#numbers.formatDecimal(p.price * (100 - p.sale) / 100, 0, 0) } + '.000 đ'"></span>
											</h5>
										</div>
									</div>
								</div>
							</th:block>
						</div>

						<hr />

						<!-- Pagination -->
						<nav aria-label="Page navigation example" class="d-flex justify-content-center mt-3">
							<ul class="pagination">
								<li class="page-item">
									<a class="page-link" th:href="@{'/web/product/' + ${cateID} + '/page/1' + '?brandID=' +${brandID}}">Trang
										đầu</a>
								</li>
								<th:block th:each="i : ${#numbers.sequence(startPage, endPage)}">
									<li th:class="${i == currentPage ? 'page-item active' : 'page-item'}">
										<a class="page-link" th:href="@{'/web/product/' + ${cateID} + '/page/' + ${i} + '?brandID=' +${brandID}}"
											th:text="${i}"></a>
									</li>
								</th:block>
								<li class="page-item">
									<a class="page-link"
										th:href="@{'/web/product/' + ${cateID} + '/page/' + ${lastPage} + '?brandID=' +${brandID}}">Trang cuối</a>
								</li>
							</ul>
						</nav>
						<!-- Pagination -->
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>